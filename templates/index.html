{% extends "base.html" %}
{% block content %}

<div class="section-title">Run SOC Simulation</div>
<div class="section-sub">Select inputs and generate a full SOC report.</div>

<form method="post">
  <div class="mb-3">
    <label class="form-label">Dataset (logs)</label>
    <select class="form-select" name="dataset" required>
      <option disabled selected>Select dataset</option>
      {% for ds in datasets %}
      <option value="{{ ds.rel }}">{{ ds.name }}</option>
      {% endfor %}
    </select>
  </div>

  <div class="mb-3">
    <label class="form-label">Sigma Rules</label>
    <select class="form-select" name="sigma" required>
      <option disabled selected>Select Sigma file</option>
      {% for r in sigma_rules %}
      <option value="{{ r.rel }}">{{ r.name }}</option>
      {% endfor %}
    </select>
  </div>

  <div class="mb-4">
    <label class="form-label">YARA Rules (optional)</label>
    <select class="form-select" name="yara">
      <option value="none" selected>None</option>
      {% for y in yara_rules %}
      <option value="{{ y.rel }}">{{ y.name }}</option>
      {% endfor %}
    </select>
  </div>

  <button class="btn btn-primary w-100">Run SOC & Generate Report</button>
</form>

{% endblock %}
