# ============================================================
# 50 WEAK / NOISY SIGMA RULES FOR TESTING SOC DETECTIONS
# GUARANTEED TO GENERATE ALERTS ON MOST SYNTHETIC DATASETS
# ============================================================

# ---- Process / Execution Weak Rules ----

- title: Weak PowerShell Match 1
  id: WEAK-PS-001
  level: low
  detection:
    sel:
      CommandLine: "*powershell*"
    condition: sel

- title: Weak PowerShell Match 2
  id: WEAK-PS-002
  level: low
  detection:
    sel:
      NewProcessName: "*powershell*"
    condition: sel

- title: Weak EXE Execution
  id: WEAK-EXE-003
  level: low
  detection:
    sel:
      NewProcessName: "*.exe"
    condition: sel

- title: Weak CMD Execution
  id: WEAK-CMD-004
  level: low
  detection:
    sel:
      CommandLine: "*cmd*"
    condition: sel

- title: Weak Python Execution
  id: WEAK-PY-005
  level: low
  detection:
    sel:
      NewProcessName: "*python*"
    condition: sel

- title: Weak Hidden Execution Indicator
  id: WEAK-HIDE-006
  level: low
  detection:
    sel:
      CommandLine: "*hidden*"
    condition: sel

- title: Weak Base64 Indicator
  id: WEAK-B64-007
  level: medium
  detection:
    sel:
      CommandLine: "*base64*"
    condition: sel

- title: Weak Suspicious Flag Usage
  id: WEAK-FLAG-008
  level: low
  detection:
    sel:
      CommandLine: "*-nop*"
    condition: sel

- title: Weak Any Powershell Parameters
  id: WEAK-PS-009
  level: low
  detection:
    sel:
      CommandLine: "*-w*"
    condition: sel

- title: Weak Encoding Flag Detection
  id: WEAK-ENC-010
  level: low
  detection:
    sel:
      CommandLine: "*-enc*"
    condition: sel


# ---- Web Request Weak Rules ----

- title: Generic URL Parameter Rule
  id: WEAK-WEB-011
  level: low
  detection:
    sel:
      RequestUri: "*?*"
    condition: sel

- title: Weak cmd= Parameter Rule
  id: WEAK-WEB-012
  level: medium
  detection:
    sel:
      RequestUri: "*cmd=*"
    condition: sel

- title: Weak whoami Indicator
  id: WEAK-WEB-013
  level: medium
  detection:
    sel:
      RequestUri: "*whoami*"
    condition: sel

- title: Weak upload.php Detection
  id: WEAK-WEB-014
  level: low
  detection:
    sel:
      RequestUri: "*upload.php*"
    condition: sel

- title: Weak shell.txt Indicator
  id: WEAK-WEB-015
  level: low
  detection:
    sel:
      RequestUri: "*shell*"
    condition: sel

- title: Weak Benign POST Rule
  id: WEAK-POST-016
  level: low
  detection:
    sel:
      HttpMethod: "POST"
    condition: sel

- title: Weak GET Rule
  id: WEAK-GET-017
  level: low
  detection:
    sel:
      HttpMethod: "GET"
    condition: sel


# ---- Message Field Weak Rules ----

- title: Weak Error Keyword
  id: WEAK-MSG-018
  level: low
  detection:
    sel:
      message: "*error*"
    condition: sel

- title: Weak Failed Keyword
  id: WEAK-MSG-019
  level: low
  detection:
    sel:
      message: "*fail*"
    condition: sel

- title: Weak Suspicious Keyword
  id: WEAK-MSG-020
  level: low
  detection:
    sel:
      message: "*sus*"
    condition: sel

- title: Weak Warning Keyword
  id: WEAK-MSG-021
  level: low
  detection:
    sel:
      message: "*warn*"
    condition: sel

- title: Weak Debug Keyword
  id: WEAK-MSG-022
  level: low
  detection:
    sel:
      message: "*debug*"
    condition: sel

- title: Weak token Indicator
  id: WEAK-MSG-023
  level: low
  detection:
    sel:
      message: "*token*"
    condition: sel


# ---- Host Matching Weak Rules ----

- title: Hostname Contains 'host'
  id: WEAK-HOST-024
  level: low
  detection:
    sel:
      host: "*host*"
    condition: sel

- title: Hostname Numeric
  id: WEAK-HOST-025
  level: low
  detection:
    sel:
      host: "*1*"
    condition: sel

- title: Hostname 2 Match
  id: WEAK-HOST-026
  level: low
  detection:
    sel:
      host: "*2*"
    condition: sel

- title: Hostname 3 Match
  id: WEAK-HOST-027
  level: low
  detection:
    sel:
      host: "*3*"
    condition: sel

- title: Hostname Any Character
  id: WEAK-HOST-028
  level: low
  detection:
    sel:
      host: "????"
    condition: sel


# ---- Random Broad Wildcard Rules ----

- title: Weak Value Contains exe
  id: WEAK-RAND-029
  level: low
  detection:
    sel:
      message: "*exe*"
    condition: sel

- title: Weak Value Contains api
  id: WEAK-RAND-030
  level: low
  detection:
    sel:
      message: "*api*"
    condition: sel

- title: Weak Numeric Indicator 1
  id: WEAK-RAND-031
  level: low
  detection:
    sel:
      random_field: 1
    condition: sel

- title: Weak Numeric Indicator 2
  id: WEAK-RAND-032
  level: low
  detection:
    sel:
      random_field: 2
    condition: sel

- title: Weak Path Indicator
  id: WEAK-RAND-033
  level: low
  detection:
    sel:
      message: "*path*"
    condition: sel

- title: Weak contains signature word 1
  id: WEAK-RAND-034
  level: low
  detection:
    sel:
      message: "*malicious*"
    condition: sel

- title: Weak contains signature word 2
  id: WEAK-RAND-035
  level: low
  detection:
    sel:
      message: "*payload*"
    condition: sel

- title: Weak User-Agent Contains Mozilla
  id: WEAK-UA-036
  level: low
  detection:
    sel:
      UserAgent: "*Mozilla*"
    condition: sel

- title: Weak User-Agent Contains curl
  id: WEAK-UA-037
  level: low
  detection:
    sel:
      UserAgent: "*curl*"
    condition: sel


# ---- More Random Weak Matches ----

- title: Weak filename txt
  id: WEAK-FILE-038
  level: low
  detection:
    sel:
      RequestUri: "*.txt*"
    condition: sel

- title: Weak suspicious '?' match 2
  id: WEAK-NOISE-039
  level: low
  detection:
    sel:
      RequestUri: "*=*"
    condition: sel

- title: Weak suspicious slash
  id: WEAK-NOISE-040
  level: low
  detection:
    sel:
      RequestUri: "/*"
    condition: sel

- title: Weak any message wildcard A
  id: WEAK-NOISE-041
  level: low
  detection:
    sel:
      message: "*a*"
    condition: sel

- title: Weak any message wildcard E
  id: WEAK-NOISE-042
  level: low
  detection:
    sel:
      message: "*e*"
    condition: sel

- title: Weak any message wildcard I
  id: WEAK-NOISE-043
  level: low
  detection:
    sel:
      message: "*i*"
    condition: sel

- title: Weak suspicious low entropy rule
  id: WEAK-NOISE-044
  level: low
  detection:
    sel:
      message: "*log*"
    condition: sel

- title: Weak suspicious includes value
  id: WEAK-NOISE-045
  level: low
  detection:
    sel:
      RequestUri: "*index*"
    condition: sel

- title: Weak suspicious includes api
  id: WEAK-NOISE-046
  level: low
  detection:
    sel:
      RequestUri: "*api*"
    condition: sel

- title: Weak suspicious includes data
  id: WEAK-NOISE-047
  level: low
  detection:
    sel:
      RequestUri: "*data*"
    condition: sel

- title: Weak suspicious includes login
  id: WEAK-NOISE-048
  level: low
  detection:
    sel:
      RequestUri: "*login*"
    condition: sel

- title: Weak suspicious includes html
  id: WEAK-NOISE-049
  level: low
  detection:
    sel:
      RequestUri: "*.html*"
    condition: sel

- title: Always Match host field
  id: WEAK-NOISE-050
  level: low
  detection:
    sel:
      host: "*"
    condition: sel
